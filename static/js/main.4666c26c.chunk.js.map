{"version":3,"sources":["level.ts","utils.ts","point.ts","field.ts","oubliette_tileset_transparent.png","game.ts","state.ts","Board.tsx","Description.tsx","sampleLevel.ts","LevelInput.tsx","App.tsx","reportWebVitals.ts","index.tsx"],"names":["Tile","range","n","Array","fill","map","_","i","Direction","parseLevel","data","height","width","console","assert","length","field","y","x","parseInt","movePoint","p","d","getTile","value","setTile","mutableField","tile","isInRange","canGoThrough","BRICK","BLOCK","includes","isFalling","pointBelow","DOWN","LADDER","ROPE","EXIT","fieldToTiles","flatMap","point","gameModelReducer","model","action","type","ActionType","Move","dir","isWaiting","beated","chara","UP","newChara","cloneModel","reflect","move","direction","Dig","target","BLANK","queue","push","popped","shift","dig","Tick","tick","Reset","createModel","level","reset","Load","levelString","gameState","JSON","parse","stringify","mutModel","mutField","exit","JEWEL","filter","xs","forEach","CHARA","initialize","selectValue","gameModel","AppContext","React","createContext","TilePos","drawCell","context","tileset","tilePosX","tilePosY","drawImage","TILE_W","TILE_H","Board","props","canvasRef","useRef","useImage","tilesetImage","useContext","state","dispatch","useEffect","canvas","current","getContext","fillStyle","fillRect","CELL_W","CELL_H","clearRect","ref","tabIndex","onKeyDown","event","key","LEFT","RIGHT","preventDefault","Description","Box","style","textAlign","children","sampleLevels","label","selectValueReducer","SetSelectValue","levelStringReducer","SetLevelString","LevelInput","setLevelString","loadLevel","TextField","rows","onChange","multiline","variant","Select","newLevelString","MenuItem","Button","onClick","DEFAULT_LEVEL_STRING","reducer","App","useReducer","waiting","interval","setInterval","clearInterval","Provider","className","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.4666c26c.chunk.js","sourcesContent":["import { range } from \"./utils\";\n\nexport enum Tile {\n  BLANK = 0,\n  BRICK = 1,\n  BLOCK = 2,\n  LADDER = 3,\n  ROPE = 4,\n  EXIT = 5,\n  JEWEL = 6,\n  CHARA = 7,\n}\n\nexport interface Level {\n  field: Tile[][];\n  width: number;\n  height: number;\n}\n\nexport const LEVEL_NROW = 12;\nexport const LEVEL_NCOL = 12;\n\nexport function parseLevel(\n  data: string,\n  height: number = LEVEL_NROW,\n  width: number = LEVEL_NCOL\n): Level {\n  console.assert(data.length === width * height);\n  const field = range(height).map((y) =>\n    range(width).map((x) => parseInt(data[y * width + x]))\n  );\n  return { field, width, height };\n}\n","export function range(n: number): number[] {\n  return Array(n)\n    .fill(0)\n    .map((_, i) => i);\n}\n\nexport function clone2dArray<T>(xss: T[][]): T[][] {\n  return xss.map((xs) => [...xs]);\n}\n","export interface Point {\n  x: number;\n  y: number;\n}\n\nexport enum Direction {\n  RIGHT = 0,\n  DOWN = 1,\n  LEFT = 2,\n  UP = 3,\n}\n\nexport function movePoint(p: Point, d: Direction): Point {\n  const dx = [1, 0, -1, 0];\n  const dy = [0, 1, 0, -1];\n  return { x: p.x + dx[d], y: p.y + dy[d] };\n}\n","import { Tile } from \"./level\";\nimport { Point, Direction, movePoint } from \"./point\";\nimport { range } from \"./utils\";\n\nexport interface Field {\n  value: Tile[][];\n  width: number;\n  height: number;\n}\n\nexport function getTile(field: Field, p: Point): Tile {\n  return field.value[p.y][p.x];\n}\n\nexport function setTile(mutableField: Field, p: Point, tile: Tile): void {\n  mutableField.value[p.y][p.x] = tile;\n}\n\nexport function isInRange(field: Field, p: Point): boolean {\n  return 0 <= p.x && p.x < field.width && 0 <= p.y && p.y < field.height;\n}\n\nexport function canGoThrough(field: Field, p: Point): boolean {\n  return (\n    isInRange(field, p) && ![Tile.BRICK, Tile.BLOCK].includes(getTile(field, p))\n  );\n}\n\nexport function isBreakable(field: Field, p: Point): boolean {\n  return (\n    isInRange(field, p) &&\n    getTile(field, p) === Tile.BRICK &&\n    canGoThrough(field, movePoint(p, Direction.UP))\n  );\n}\n\nexport function isFalling(field: Field, p: Point) {\n  const pointBelow = movePoint(p, Direction.DOWN);\n  return !(\n    [Tile.LADDER, Tile.ROPE, Tile.EXIT].includes(getTile(field, p)) ||\n    !isInRange(field, pointBelow) ||\n    [Tile.BRICK, Tile.BLOCK, Tile.LADDER, Tile.EXIT].includes(\n      getTile(field, pointBelow)\n    )\n  );\n}\n\nexport function fieldToTiles(field: Field) {\n  return range(field.height).flatMap((y) =>\n    range(field.width).map((x) => {\n      const point = { x, y };\n      const tile = getTile(field, point);\n      return { point, tile };\n    })\n  );\n}\n\nexport function countJewel(field: Field) {\n  return fieldToTiles(field).filter(({ tile }) => tile === Tile.JEWEL).length;\n}\n","export default \"data:image/png;base64,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\"","import { Action, ActionType } from \"./state\";\nimport {\n  canGoThrough,\n  countJewel,\n  Field,\n  getTile,\n  isBreakable,\n  isFalling,\n  setTile,\n} from \"./field\";\nimport { Level, parseLevel, Tile } from \"./level\";\nimport { Direction, movePoint, Point } from \"./point\";\nimport { clone2dArray, range } from \"./utils\";\n\nconst MAXQ = 5;\n\nexport interface GameModel {\n  level: Level;\n  field: Field;\n  chara: Point;\n  exit: Point;\n  queue: Point[];\n  beated: boolean;\n}\n\nexport const gameModelReducer = (\n  model: GameModel,\n  action: Action\n): GameModel => {\n  switch (action.type) {\n    case ActionType.Move:\n      return move(model, action.direction);\n    case ActionType.Dig:\n      return dig(model, action.direction);\n    case ActionType.Tick:\n      return tick(model);\n    case ActionType.Reset:\n      return reset(model);\n    case ActionType.Load:\n      return createModel(parseLevel(action.levelString));\n    default:\n      return model;\n  }\n};\n\nfunction cloneModel(gameState: GameModel): GameModel {\n  return JSON.parse(JSON.stringify(gameState));\n}\n\nfunction reflect(mutModel: GameModel): void {\n  const { field: mutField, chara, exit } = mutModel;\n  if (getTile(mutField, chara) === Tile.JEWEL) {\n    setTile(mutField, chara, Tile.BLANK);\n  }\n  if (getTile(mutField, chara) === Tile.EXIT) {\n    mutModel.beated = true;\n  }\n  if (countJewel(mutField) === 0) {\n    setTile(mutField, exit, Tile.EXIT);\n  }\n}\n\nexport function isWaiting(model: GameModel): boolean {\n  return isFalling(model.field, model.chara);\n}\n\nexport function createModel(level: Level): GameModel {\n  const { width, height } = level;\n\n  let value: Tile[][] = clone2dArray(level.field);\n  let chara: Point = { x: 0, y: 0 };\n  let exit: Point = { x: 0, y: 0 };\n\n  range(height).forEach((y) => {\n    range(width).forEach((x) => {\n      switch (value[y][x]) {\n        case Tile.CHARA:\n          value[y][x] = Tile.BLANK;\n          chara = { x, y };\n          break;\n        case Tile.EXIT:\n          value[y][x] = Tile.BRICK;\n          exit = { x, y };\n          break;\n      }\n    });\n  });\n\n  const field = { value, width, height };\n  return { level, field, chara, exit, queue: [], beated: false };\n}\n\nfunction reset(model: GameModel): GameModel {\n  return createModel(model.level);\n}\n\nfunction move(model: GameModel, dir: Direction): GameModel {\n  if (isWaiting(model)) return model;\n  if (model.beated) return model;\n\n  if (\n    getTile(model.field, model.chara) === Tile.BRICK ||\n    (dir === Direction.UP && getTile(model.field, model.chara) !== Tile.LADDER)\n  ) {\n    return model;\n  }\n  const newChara = movePoint(model.chara, dir);\n  if (!canGoThrough(model.field, newChara)) return model;\n\n  model = cloneModel(model);\n  model.chara = newChara;\n  reflect(model);\n\n  return model;\n}\n\nfunction dig(\n  model: GameModel,\n  dir: Direction.LEFT | Direction.RIGHT\n): GameModel {\n  if (isWaiting(model)) return model;\n  if (model.beated) return model;\n\n  const target = movePoint(movePoint(model.chara, Direction.DOWN), dir);\n  if (!isBreakable(model.field, target)) {\n    return model;\n  }\n\n  model = cloneModel(model);\n  setTile(model.field, target, Tile.BLANK);\n  model.queue.push(target);\n  if (model.queue.length > MAXQ) {\n    const popped = model.queue.shift()!;\n    if (getTile(model.field, popped) === Tile.BLANK) {\n      setTile(model.field, popped, Tile.BRICK);\n    }\n  }\n\n  return model;\n}\n\nfunction tick(model: GameModel) {\n  if (isFalling(model.field, model.chara)) {\n    model = cloneModel(model);\n    model.chara = movePoint(model.chara, Direction.DOWN);\n    reflect(model);\n    return model;\n  } else {\n    return model;\n  }\n}\n","import React from \"react\";\nimport { createModel, GameModel } from \"./game\";\nimport { parseLevel } from \"./level\";\nimport { Direction } from \"./point\";\n\nexport interface State {\n  selectValue: string;\n  levelString: string;\n  gameModel: GameModel;\n}\n\nexport const initialize = (levelString: string) => ({\n  selectValue: levelString,\n  levelString: levelString,\n  gameModel: createModel(parseLevel(levelString)),\n});\n\nexport enum ActionType {\n  Move,\n  Dig,\n  Reset,\n  Tick,\n  Load,\n  SetSelectValue,\n  SetLevelString,\n}\n\nexport type Action =\n  | {\n      type: ActionType.Move;\n      direction: Direction;\n    }\n  | {\n      type: ActionType.Dig;\n      direction: Direction.LEFT | Direction.RIGHT;\n    }\n  | {\n      type: ActionType.Reset;\n    }\n  | {\n      type: ActionType.Tick;\n    }\n  | {\n      type: ActionType.Load;\n      levelString: string;\n    }\n  | {\n      type: ActionType.SetSelectValue;\n      value: string;\n    }\n  | {\n      type: ActionType.SetLevelString;\n      value: string;\n    };\n\ninterface AppContextInterface {\n  state: State;\n  dispatch: React.Dispatch<Action>;\n}\n\nexport const AppContext = React.createContext<AppContextInterface | null>(null);\n","import React, { useRef, useEffect, useContext } from \"react\";\nimport { LEVEL_NCOL, LEVEL_NROW, Tile } from \"./level\";\nimport { Direction, Point } from \"./point\";\nimport { fieldToTiles } from \"./field\";\nimport tileset from \"./oubliette_tileset_transparent.png\";\nimport useImage from \"use-image\";\nimport { ActionType, AppContext } from \"./state\";\n\nconst TILE_W = 16;\nconst TILE_H = 16;\n\nexport const CELL_W = TILE_W * 3;\nexport const CELL_H = TILE_H * 3;\n\nconst TilePos = {\n  [Tile.BLANK]: { x: 6, y: 5 },\n  [Tile.BRICK]: { x: 4, y: 0 },\n  [Tile.BLOCK]: { x: 3, y: 0 },\n  [Tile.LADDER]: { x: 5, y: 4 },\n  [Tile.ROPE]: { x: 6, y: 2 },\n  [Tile.EXIT]: { x: 3, y: 3 },\n  [Tile.JEWEL]: { x: 4, y: 3 },\n  [Tile.CHARA]: { x: 1, y: 7 },\n};\n\nconst WIDTH = CELL_W * LEVEL_NCOL;\nconst HEIGHT = CELL_H * LEVEL_NROW;\n\ninterface BoardProps {\n  tabIndex: number;\n}\n\nfunction drawCell(\n  context: CanvasRenderingContext2D,\n  tileset: HTMLImageElement,\n  { x, y }: Point,\n  tile: Tile\n) {\n  const { x: tilePosX, y: tilePosY } = TilePos[tile];\n  context.drawImage(\n    tileset,\n    tilePosX * TILE_W + 0.25,\n    tilePosY * TILE_H + 0.25,\n    TILE_W - 0.25,\n    TILE_H - 0.25,\n    CELL_W * x,\n    CELL_H * y,\n    CELL_W,\n    CELL_H\n  );\n}\n\nexport default function Board(props: BoardProps) {\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n  const [tilesetImage] = useImage(tileset);\n\n  const { state, dispatch } = useContext(AppContext)!;\n\n  useEffect(() => {\n    if (!tilesetImage) return;\n\n    const canvas = canvasRef.current!;\n    if (!canvas) return;\n    const context = canvas.getContext(\"2d\")!;\n\n    context.fillStyle = \"#0f0f3e\";\n    context.fillRect(0, 0, WIDTH, HEIGHT);\n\n    const { field, chara, beated } = state.gameModel;\n    fieldToTiles(field)\n      .filter(({ tile }) => tile !== Tile.BLANK)\n      .forEach(({ point, tile }) => {\n        drawCell(context, tilesetImage, point, tile);\n      });\n    if (!beated) drawCell(context, tilesetImage, chara, Tile.CHARA);\n\n    return () => context.clearRect(0, 0, WIDTH, HEIGHT);\n  });\n\n  const onKeyDown = (event: React.KeyboardEvent<HTMLCanvasElement>) => {\n    switch (event.key) {\n      case \"ArrowDown\":\n        dispatch({ type: ActionType.Move, direction: Direction.DOWN });\n        break;\n      case \"ArrowLeft\":\n        dispatch({ type: ActionType.Move, direction: Direction.LEFT });\n        break;\n      case \"ArrowRight\":\n        dispatch({ type: ActionType.Move, direction: Direction.RIGHT });\n        break;\n      case \"ArrowUp\":\n        dispatch({ type: ActionType.Move, direction: Direction.UP });\n        break;\n      case \"z\":\n        dispatch({ type: ActionType.Dig, direction: Direction.LEFT });\n        break;\n      case \"x\":\n        dispatch({ type: ActionType.Dig, direction: Direction.RIGHT });\n        break;\n      case \"r\":\n        dispatch({ type: ActionType.Reset });\n        break;\n    }\n    event.preventDefault();\n  };\n\n  return (\n    <canvas\n      ref={canvasRef}\n      width={WIDTH}\n      height={HEIGHT}\n      tabIndex={props.tabIndex}\n      onKeyDown={onKeyDown}\n    />\n  );\n}\n","import { Box } from \"@material-ui/core\";\nimport React from \"react\";\nimport ReactMarkdown from \"react-markdown\";\n\nconst description = `\n# Pink Virus Puzzle\nかつてパズルゲームサイト「[ぼらＱ](https://web.archive.org/web/20060116224359/http://boraq.hp.infoseek.co.jp/main.htm)」\\\nに掲載されていたパズルゲーム「Pink Virus」のクローンです。\n\n## ルール\n鍵を全部集めて出口を目指しましょう。\n- 主人公は上下左右に移動することができます。\n  - 移動は重力の影響を受けます：移動後、以下のいずれかの条件を満たすまで落下します。\n    1. 主人公のいるマスにハシゴかロープが存在する。\n    2. 主人公の下のマスに足場（レンガ・ブロック・ハシゴ・床）が存在する。\n  - レンガとブロックのあるマスは通過することができません。\n  - 上方向への移動はハシゴのあるマスでのみ可能です。\n- 主人公は自分の左下・右下にあるレンガを破壊することができます。\n  - 対象のレンガの上に他のレンガやブロックがある場合は破壊することができません。\n  - 同時に破壊することができるレンガは5個までです。6個めのレンガを破壊すると最初に破壊したレンガが復活します。\n  - 主人公が復活したレンガに埋まってしまった場合はゲームオーバーです。\n\n## 操作方法\n- ←/↑/→/↓: 移動\n- Z/X: 左下・右下のレンガを壊す\n- R: リスタート\n\n## ソースコード\n- <https://github.com/ukikagi/pink-virus-puzzle/>\n`;\n\nexport const Description = () => (\n  <Box style={{ textAlign: \"left\" }}>\n    <ReactMarkdown children={description} />\n  </Box>\n);\n","export const sampleLevels = [\n  {\n    label: \"classic-beginner1\",\n    data:\n      \"044444400000006000030000000000030700011110031111010610030000011210034000000000000300004000000300000600000300000100000310001110000310051111000316\",\n  },\n  {\n    label: \"classic-beginner2\",\n    data:\n      \"000000000000000000000007111112111111111116111111111111111111000000600000000000000000111113122222111113111111006003144444444443100006000000000005\",\n  },\n  {\n    label: \"classic-beginner3\",\n    data:\n      \"064444000070030003003030034403043030000003003000000603403000000006003000000003003400004403406000000003003000000003003400000043043000500000000000\",\n  },\n  {\n    label: \"classic-beginner4\",\n    data:\n      \"000000000000444400000000300000070000300212121212300060000060340000000000003111111111003111111111003111161111003000100001613000000001503003100001\",\n  },\n  {\n    label: \"classic-intermediate1\",\n    data:\n      \"000000000000000000700000000061111111311111111111321221211116304440611113110001111113010001110003001011112222000100161111000100044445000100000001\",\n  },\n  {\n    label: \"classic-intermediate2\",\n    data:\n      \"000007000000101111111035131060111031131111122031131211000031131163132031131111131031131131136031131111161031136113111031111161301031000000110030\",\n  },\n  {\n    label: \"classic-intermediate3\",\n    data:\n      \"000007000000000022200000000000000000000000000000004444404030613000016230013000002030013000000030013000000030613002613030122222222222000000000005\",\n  },\n  {\n    label: \"classic-advanced1\",\n    data:\n      \"000000000700000002311111311131131111311131111111311131111111311131000611311601132212311000032200351220100202300001613262311111203202300000003000\",\n  },\n  {\n    label: \"classic-advanced2\",\n    data:\n      \"000000000000000444420000073232620000212230000000060032121300220500000230001300000030444060606030600000000030000022222030000000000316222222222222\",\n  },\n  {\n    label: \"classic-advanced3\",\n    data:\n      \"000000000000031111153000031110710300031111110300030060600300030000000300030606060300030000000300030000000300030000000300031220222213061000000013\",\n  },\n  {\n    label: \"classic-german1\",\n    data:\n      \"040440007000101001111231101111111231161161100031101111060231101111111231101111111231101111111231101116111231000000000030101111111131111111100035\",\n  },\n  {\n    label: \"classic-german2\",\n    data:\n      \"000000000000444374430000600321030000444316100310000011000316444444311110600000311110012222211111100000000005110000000311111000003111222222222222\",\n  },\n  {\n    label: \"classic-german3\",\n    data:\n      \"000000004440000000003000000000003000000000003000304040403000310101010060301616100000344404047000300010101000300000000000300000400000300000016105\",\n  },\n  {\n    label: \"classic-german4\",\n    data:\n      \"000000000000000000000000000000000000000000007000322222202222300000000005301111111111301111111111301212121212300000000000300262626262310000000000\",\n  },\n  {\n    label: \"sample-pillar\",\n    data:\n      \"000000000000\" +\n      \"000007000000\" +\n      \"000003500000\" +\n      \"000003100000\" +\n      \"000003100000\" +\n      \"000003100000\" +\n      \"000003130000\" +\n      \"000000130000\" +\n      \"000003130000\" +\n      \"000003100000\" +\n      \"000003130000\" +\n      \"000006130000\",\n  },\n];\n","import { Button, MenuItem, Select, TextField } from \"@material-ui/core\";\nimport React, { useContext } from \"react\";\nimport { Action, ActionType, AppContext } from \"./state\";\nimport { sampleLevels } from \"./sampleLevel\";\n\nexport const selectValueReducer = (\n  selectValue: string,\n  action: Action\n): string => {\n  switch (action.type) {\n    case ActionType.SetSelectValue:\n      return action.value;\n    default:\n      return selectValue;\n  }\n};\n\nexport const levelStringReducer = (\n  levelString: string,\n  action: Action\n): string => {\n  switch (action.type) {\n    case ActionType.SetLevelString:\n      return action.value;\n    default:\n      return levelString;\n  }\n};\n\nconst LevelInput = () => {\n  const { state, dispatch } = useContext(AppContext)!;\n\n  const setLevelString = (value: string) =>\n    dispatch({ type: ActionType.SetLevelString, value: value });\n  const setSelectValue = (value: string) =>\n    dispatch({ type: ActionType.SetSelectValue, value: value });\n\n  function onLevelStringChange(event: React.ChangeEvent<{ value: string }>) {\n    setLevelString(event.target.value);\n  }\n\n  function onSelectChange(event: React.ChangeEvent<{ value: unknown }>) {\n    const newLevelString = event.target.value as string;\n    setLevelString(newLevelString);\n    setSelectValue(newLevelString);\n    loadLevel(newLevelString);\n  }\n\n  function onClick() {\n    loadLevel(state.levelString);\n  }\n\n  function loadLevel(levelString: string) {\n    dispatch({ type: ActionType.Load, levelString: levelString });\n  }\n\n  return (\n    <>\n      <TextField\n        value={state.levelString}\n        rows={3}\n        onChange={onLevelStringChange}\n        multiline\n        variant=\"outlined\"\n        style={{ width: 480 }}\n      />\n      <Select\n        variant=\"outlined\"\n        value={state.selectValue}\n        onChange={onSelectChange}\n        style={{ width: 320 }}\n      >\n        {sampleLevels.map(({ label, data }) => (\n          <MenuItem key={label} value={data}>\n            {label}\n          </MenuItem>\n        ))}\n      </Select>\n      <Button onClick={onClick} variant=\"contained\" children=\"Refresh\" />\n    </>\n  );\n};\n\nexport default LevelInput;\n","import { Box } from \"@material-ui/core\";\nimport React, { useEffect, useReducer } from \"react\";\nimport \"./App.css\";\nimport Board from \"./Board\";\nimport { Description } from \"./Description\";\nimport { gameModelReducer, isWaiting } from \"./game\";\nimport LevelInput, {\n  levelStringReducer,\n  selectValueReducer,\n} from \"./LevelInput\";\nimport { sampleLevels } from \"./sampleLevel\";\nimport { Action, ActionType, AppContext, initialize, State } from \"./state\";\n\nconst DEFAULT_LEVEL_STRING = sampleLevels[0].data;\nconst TICK_DELAY = 80;\n\nconst reducer = (state: State, action: Action): State => ({\n  selectValue: selectValueReducer(state.selectValue, action),\n  levelString: levelStringReducer(state.levelString, action),\n  gameModel: gameModelReducer(state.gameModel, action),\n});\n\nfunction App() {\n  const [state, dispatch] = useReducer(\n    reducer,\n    DEFAULT_LEVEL_STRING,\n    initialize\n  );\n\n  const waiting = isWaiting(state.gameModel);\n  useEffect(() => {\n    if (!waiting) return;\n    const interval = setInterval(\n      () => dispatch({ type: ActionType.Tick }),\n      TICK_DELAY\n    );\n    return () => clearInterval(interval);\n  }, [waiting]);\n\n  return (\n    <AppContext.Provider value={{ state, dispatch }}>\n      <Box className=\"App\">\n        <Description />\n        <Board tabIndex={0} />\n        <LevelInput />\n      </Box>\n    </AppContext.Provider>\n  );\n}\n\nexport default App;\n","import { ReportHandler } from \"web-vitals\";\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import(\"web-vitals\").then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport reportWebVitals from \"./reportWebVitals\";\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}